console.log("Javascript code to create a database and perform operations on it.")
const usersDB = [
    { 
        id: 1, name: 'Alice', roleId: 1 },
    {
        id: 2, name: 'Bob', roleId: 2 },
    { 
        id: 3, name: 'Charlie', roleId: 3 
    }
];
const rolesDB = [
    { roleId: 1, roleName: 'Viewer', permissions: ['read'] },
    { roleId: 2, roleName: 'Editor', permissions: ['read', 'write'] },
    { 
        roleId: 3, roleName: 'Admin', permissions: ['read', 'write', 'delete']
    }
];
function grantPermission(userId, permission) 
{
    const user = usersDB.find(u => u.id === userId);
    if (user) 
    { 
        const role = rolesDB.find(r => r.roleId === user.roleId);
        if (role && !role.permissions.includes(permission)) 
        {
            role.permissions.push(permission);
            console.log(`GRANTED '${permission}' to user ${user.name}`);
        } 
        else if (role && role.permissions.includes(permission)) 
        {
            console.log(`User ${user.name} already has '${permission}' permission.`);
        }
    } 
    else 
    {
        console.log(`User ID ${userId} not found.`);
    }
}
function revokePermission(userId, permission) 
{
    const user = usersDB.find(u => u.id === userId);
    if (user) 
    {
        const role = rolesDB.find(r => r.roleId === user.roleId);
        const index = role.permissions.indexOf(permission);
        if (index > -1) 
        {
            role.permissions.splice(index, 1);
            console.log(`REVOKED '${permission}' from user ${user.name}`);
        } 
        else
        {
            console.log(`User ${user.name} did not have '${permission}' permission.`);
        }
    }
}
function leftJoinUsersAndRoles(users, roles)
{
    const joinedData = users.map(user => 
    {
        const role = roles.find(roleItem => roleItem.roleId === user.roleId);
        return 
        {
            id: user.id,
            name: user.name,
            roleName: role ? role.roleName : 'Unknown',
            permissions: role ? role.permissions : []
        };
    });
    return joinedData;
}
console.log("Initial Data");
console.table(leftJoinUsersAndRoles(usersDB, rolesDB));
console.log("Granting 'delete' permission to Alice");
grantPermission(1, 'delete');
console.table(leftJoinUsersAndRoles(usersDB, rolesDB)); 
console.log("Revoking 'write' permission from Bob");
revokePermission(2, 'write'); 
console.table(leftJoinUsersAndRoles(usersDB, rolesDB)); 
